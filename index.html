<!DOCTYPE html>

<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô - Service Staff</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }

body {
font-family: ‚ÄòSarabun‚Äô, sans-serif;
background: #dedad3;
min-height: 100vh;
color: #2c2c2c;
}

/* ===== TOOLBAR ‚Äî ‡∏ó‡∏∂‡∏ö‡πÅ‡∏™‡∏á 100% ===== */
.toolbar {
position: fixed;
top: 0; left: 0; right: 0;
height: 56px;
background: #1a2744;
padding: 0 16px;
display: flex;
align-items: center;
justify-content: space-between;
z-index: 9999;
box-shadow: 0 3px 14px rgba(0,0,0,0.55);
isolation: isolate;
}

.toolbar-title {
font-family: ‚ÄòPrompt‚Äô, sans-serif;
color: #c9a84c;
font-size: 0.88rem;
font-weight: 600;
white-space: nowrap;
overflow: hidden;
text-overflow: ellipsis;
max-width: 52%;
}

.toolbar-actions { display: flex; gap: 8px; flex-shrink: 0; }

.btn {
padding: 7px 13px;
border: none;
border-radius: 5px;
font-family: ‚ÄòSarabun‚Äô, sans-serif;
font-size: 0.8rem;
font-weight: 700;
cursor: pointer;
display: flex;
align-items: center;
gap: 4px;
transition: opacity 0.2s;
white-space: nowrap;
}
.btn:hover { opacity: 0.82; }
.btn:disabled { opacity: 0.45; cursor: not-allowed; }
.btn-primary { background: #c9a84c; color: #1a2744; }
.btn-outline  { background: transparent; color: #c9a84c; border: 1.5px solid #c9a84c; }

/* ===== LAYOUT ===== */
.page-wrapper {
padding: 72px 16px 48px;
display: flex;
flex-direction: column;
align-items: center;
gap: 14px;
}

.form-instructions {
max-width: 794px;
width: 100%;
background: #1a2744;
color: #f5f3ee;
padding: 10px 16px;
border-radius: 6px;
font-size: 0.84rem;
text-align: center;
line-height: 1.6;
}
.form-instructions strong { color: #c9a84c; }

/* ===== DOCUMENT ===== */
#document {
width: 100%;
max-width: 794px;
background: #ffffff;
padding: 34px 42px;
box-shadow: 0 4px 24px rgba(0,0,0,0.18);
border-top: 5px solid #1a2744;
}

.doc-title {
text-align: center;
font-family: ‚ÄòPrompt‚Äô, sans-serif;
font-size: 1.12rem;
font-weight: 700;
color: #1a2744;
border-bottom: 2.5px solid #c9a84c;
padding-bottom: 7px;
margin-bottom: 5px;
}
.doc-subtitle {
text-align: center;
font-size: 0.82rem;
color: #6b6b6b;
margin-bottom: 16px;
font-family: ‚ÄòPrompt‚Äô, sans-serif;
font-weight: 500;
}

/* ===== INFO ===== */
.info-grid {
display: grid;
grid-template-columns: 1fr 1fr 1fr;
gap: 12px;
margin-bottom: 14px;
}
.info-field { display: flex; flex-direction: column; gap: 3px; }
.info-label {
font-size: 0.67rem;
color: #6b6b6b;
font-weight: 700;
text-transform: uppercase;
letter-spacing: 0.06em;
}
.info-input {
border: none;
border-bottom: 1.5px solid #c5b99a;
padding: 4px 2px;
font-family: ‚ÄòSarabun‚Äô, sans-serif;
font-size: 0.92rem;
color: #2c2c2c;
background: transparent;
width: 100%;
outline: none;
transition: border-color 0.2s;
}
.info-input:focus { border-color: #1a2744; }

/* ===== INSTRUCTION ===== */
.instruction-box {
background: #f0ede6;
border-left: 4px solid #c9a84c;
padding: 9px 13px;
font-size: 0.81rem;
color: #4a4a4a;
margin-bottom: 14px;
border-radius: 0 4px 4px 0;
line-height: 1.65;
}
.instruction-box strong { color: #1a2744; }

/* ===== TABLE ===== */
.eval-table {
width: 100%;
border-collapse: collapse;
margin-bottom: 18px;
font-size: 0.84rem;
}
.eval-table thead tr:first-child th {
background: #1a2744;
color: #ffffff;
padding: 10px 10px;
font-family: ‚ÄòPrompt‚Äô, sans-serif;
font-weight: 600;
font-size: 0.79rem;
border: 1px solid #0d1a35;
vertical-align: middle;
text-align: center;
}
.eval-table thead tr:first-child th:nth-child(2) { text-align: left; }
.eval-table thead tr:last-child th {
background: #1a2744;
border: 1px solid #0d1a35;
padding: 0;
vertical-align: middle;
}
.eval-table thead tr:last-child th.th-fail {
background: #b03025;
color: white;
font-weight: 700;
font-size: 0.79rem;
padding: 7px 0;
text-align: center;
border: 1px solid #8a1f18;
width: 66px;
font-family: ‚ÄòPrompt‚Äô, sans-serif;
}
.eval-table thead tr:last-child th.th-pass {
background: #1f6b3a;
color: white;
font-weight: 700;
font-size: 0.79rem;
padding: 7px 0;
text-align: center;
border: 1px solid #144d28;
width: 66px;
font-family: ‚ÄòPrompt‚Äô, sans-serif;
}

.eval-table tbody tr:nth-child(odd)  { background: #ffffff; }
.eval-table tbody tr:nth-child(even) { background: #f6f4ef; }
.eval-table tbody tr:hover           { background: #ede9df; }
.eval-table tr.row-pass td { background: #d4edda !important; }
.eval-table tr.row-fail td { background: #f8d7da !important; }
.eval-table tr.row-pass td.row-num,
.eval-table tr.row-fail td.row-num { background: #2a3d6b !important; color: #ffffff !important; }

.eval-table td {
padding: 9px 10px;
vertical-align: middle;
border: 1px solid #ccc5b5;
}
.row-num {
text-align: center;
font-weight: 700;
color: #ffffff;
background: #2a3d6b !important;
width: 42px;
}
.criteria-text { line-height: 1.5; }
.radio-cell { text-align: center; }
.radio-option {
display: inline-flex;
align-items: center;
justify-content: center;
cursor: pointer;
padding: 4px;
border-radius: 50%;
transition: background 0.15s;
}
.radio-option:hover { background: rgba(0,0,0,0.07); }
.radio-option input[type=‚Äúradio‚Äù] { display: none; }
.radio-circle {
width: 22px; height: 22px;
border-radius: 50%;
border: 2px solid #b0a898;
display: flex; align-items: center; justify-content: center;
transition: all 0.2s;
}
.radio-circle::after {
content: ‚Äò‚Äô;
width: 10px; height: 10px;
border-radius: 50%;
background: transparent;
transition: all 0.2s;
}
.fail-option input[type=‚Äúradio‚Äù]:checked + .radio-circle { border-color: #b03025; background: #b03025; }
.fail-option input[type=‚Äúradio‚Äù]:checked + .radio-circle::after { background: white; }
.pass-option input[type=‚Äúradio‚Äù]:checked + .radio-circle { border-color: #1f6b3a; background: #1f6b3a; }
.pass-option input[type=‚Äúradio‚Äù]:checked + .radio-circle::after { background: white; }

.remark-input {
border: none;
border-bottom: 1px dashed #c5b99a;
width: 100%;
font-family: ‚ÄòSarabun‚Äô, sans-serif;
font-size: 0.81rem;
color: #2c2c2c;
background: transparent;
padding: 2px 3px;
outline: none;
min-width: 0;
}
.remark-input:focus { border-bottom-color: #1a2744; }

/* remark popup cell */
.remark-cell {
cursor: pointer;
min-width: 80px;
}
.remark-cell:hover { background: rgba(201,168,76,0.08) !important; }
.remark-preview {
padding: 2px 0;
min-height: 22px;
display: flex;
align-items: center;
}
.remark-placeholder {
font-size: 0.75rem;
color: #bbb;
font-style: italic;
white-space: nowrap;
}
.remark-text {
font-size: 0.78rem;
color: #2c2c2c;
line-height: 1.4;
display: -webkit-box;
-webkit-line-clamp: 2;
-webkit-box-orient: vertical;
overflow: hidden;
}

/* ===== SUMMARY ===== */
.summary-section {
border: 1.5px solid #c5b99a;
border-radius: 6px;
overflow: hidden;
margin-bottom: 18px;
}
.summary-title {
background: #f0ede6;
padding: 8px 13px;
font-weight: 700;
font-size: 0.82rem;
color: #1a2744;
border-bottom: 1px solid #c5b99a;
font-family: ‚ÄòPrompt‚Äô, sans-serif;
}
.summary-body { padding: 12px 13px; display: flex; flex-direction: column; gap: 10px; }
.additional-remark {
width: 100%;
border: 1px solid #c5b99a;
border-radius: 4px;
padding: 7px 10px;
font-family: ‚ÄòSarabun‚Äô, sans-serif;
font-size: 0.84rem;
color: #2c2c2c;
resize: vertical;
min-height: 54px;
outline: none;
transition: border-color 0.2s;
}
.additional-remark:focus { border-color: #1a2744; }
.result-label {
font-size: 0.82rem;
font-weight: 700;
color: #1a2744;
font-family: ‚ÄòPrompt‚Äô, sans-serif;
}
.result-options { display: flex; flex-direction: column; gap: 7px; }
.result-option {
display: flex;
align-items: center;
gap: 12px;
cursor: pointer;
padding: 11px 14px;
border-radius: 5px;
border: 1.5px solid #c5b99a;
transition: all 0.2s;
background: white;
}
.result-option:hover { border-color: #1a2744; background: #f8f6f2; }
/* native radio ‚Äî ‡∏ã‡πà‡∏≠‡∏ô hidden class ‡πÄ‡∏î‡∏¥‡∏° */
.result-option input[type=‚Äúradio‚Äù] {
width: 20px; height: 20px;
flex-shrink: 0;
cursor: pointer;
margin: 0;
accent-color: #1a2744;
}
.result-option.selected-fail { border-color: #b03025; background: #fdf0f0; }
.result-option.selected-fail input[type=‚Äúradio‚Äù] { accent-color: #b03025; }
.result-option.selected-pass { border-color: #1f6b3a; background: #e8f4ec; }
.result-option.selected-pass input[type=‚Äúradio‚Äù] { accent-color: #1f6b3a; }
.result-text { font-size: 0.87rem; line-height: 1.4; }
.result-text strong { font-family: ‚ÄòPrompt‚Äô, sans-serif; }

/* ===== SIGNATURE ===== */
.signature-section {
display: flex;
justify-content: center;
margin-top: 8px;
}
.sig-box {
display: flex;
flex-direction: column;
align-items: center;
gap: 6px;
width: 210px;
}
.sig-title {
font-size: 0.82rem;
color: #6b6b6b;
font-weight: 700;
font-family: ‚ÄòPrompt‚Äô, sans-serif;
}
.sig-name-input {
border: none;
border-bottom: 1.5px solid #c5b99a;
text-align: center;
padding: 4px 8px;
font-family: ‚ÄòSarabun‚Äô, sans-serif;
font-size: 0.9rem;
color: #2c2c2c;
background: transparent;
outline: none;
width: 180px;
}
.sig-name-input:focus { border-color: #1a2744; }
.sig-date { font-size: 0.74rem; color: #6b6b6b; }

/* ===== SCORE BADGE ===== */
.score-badge {
position: fixed;
bottom: 20px; right: 16px;
background: #1a2744;
color: white;
padding: 12px 16px;
border-radius: 12px;
box-shadow: 0 4px 20px rgba(0,0,0,0.3);
text-align: center;
min-width: 105px;
z-index: 500;
}
.score-number {
font-family: ‚ÄòPrompt‚Äô, sans-serif;
font-size: 1.85rem;
font-weight: 700;
color: #c9a84c;
line-height: 1;
}
.score-label { font-size: 0.68rem; color: #aaa; margin-top: 2px; }
.score-bar {
width: 100%; height: 4px;
background: rgba(255,255,255,0.15);
border-radius: 2px; margin-top: 8px; overflow: hidden;
}
.score-fill {
height: 100%;
background: #c9a84c;
border-radius: 2px;
transition: width 0.4s ease;
}

/* ===== REMARK MODAL ===== */
.modal-overlay {
display: none;
position: fixed;
inset: 0;
background: rgba(0,0,0,0.55);
z-index: 9000;
align-items: flex-end;
justify-content: center;
}
.modal-overlay.active { display: flex; }

.modal-box {
background: #fff;
width: 100%;
max-width: 540px;
border-radius: 18px 18px 0 0;
padding: 20px 20px 32px;
box-shadow: 0 -6px 30px rgba(0,0,0,0.2);
animation: slideUp 0.22s ease;
}
@keyframes slideUp {
from { transform: translateY(60px); opacity: 0; }
to   { transform: translateY(0);    opacity: 1; }
}

.modal-handle {
width: 40px; height: 4px;
background: #d0ccc4;
border-radius: 2px;
margin: 0 auto 16px;
}

.modal-title {
font-family: ‚ÄòPrompt‚Äô, sans-serif;
font-size: 0.92rem;
font-weight: 700;
color: #1a2744;
margin-bottom: 4px;
}
.modal-subtitle {
font-size: 0.75rem;
color: #888;
margin-bottom: 12px;
}

.modal-textarea {
width: 100%;
border: 1.5px solid #c5b99a;
border-radius: 8px;
padding: 12px 14px;
font-family: ‚ÄòSarabun‚Äô, sans-serif;
font-size: 0.92rem;
color: #2c2c2c;
resize: none;
height: 160px;
outline: none;
transition: border-color 0.2s;
line-height: 1.6;
}
.modal-textarea:focus { border-color: #1a2744; }

.modal-char {
text-align: right;
font-size: 0.73rem;
color: #999;
margin-top: 5px;
margin-bottom: 14px;
}
.modal-char.near-limit { color: #c0392b; }

.modal-actions {
display: flex;
gap: 10px;
}
.modal-btn {
flex: 1;
padding: 12px;
border: none;
border-radius: 8px;
font-family: ‚ÄòSarabun‚Äô, sans-serif;
font-size: 0.9rem;
font-weight: 700;
cursor: pointer;
transition: opacity 0.2s;
}
.modal-btn:hover { opacity: 0.82; }
.modal-btn-cancel { background: #f0ede6; color: #6b6b6b; }
.modal-btn-save   { background: #1a2744; color: #c9a84c; }
.page-wrapper { padding: 64px 10px 48px; gap: 10px; }
#document { padding: 18px 12px; border-top-width: 4px; }
.doc-title { font-size: 1rem; }
.info-grid { grid-template-columns: 1fr 1fr; gap: 10px; }
.info-input { font-size: 0.88rem; }
.instruction-box { font-size: 0.78rem; }

```
/* table ‚Äî ‡∏•‡∏î column ‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
.eval-table { font-size: 0.74rem; }
.eval-table thead tr:first-child th,
.eval-table thead tr:last-child th { padding: 7px 4px; font-size: 0.72rem; }
.eval-table td { padding: 7px 5px; }
.eval-table td.row-num { width: 28px; font-size: 0.72rem; }
.eval-table thead tr:last-child th.th-fail,
.eval-table thead tr:last-child th.th-pass { width: 48px; }
.remark-input { font-size: 0.72rem; }

/* result */
.result-option { padding: 10px 12px; gap: 10px; }
.result-text { font-size: 0.82rem; }

/* toolbar */
.toolbar-title { font-size: 0.78rem; }
.btn { padding: 6px 10px; font-size: 0.75rem; }

/* score badge */
.score-badge { bottom: 14px; right: 10px; padding: 10px 12px; min-width: 88px; }
.score-number { font-size: 1.6rem; }
```

}

@media (max-width: 380px) {
.info-grid { grid-template-columns: 1fr; }
.eval-table { font-size: 0.7rem; }
.eval-table thead tr:last-child th.th-fail,
.eval-table thead tr:last-child th.th-pass { width: 40px; font-size: 0.68rem; }
}
</style>

</head>
<body>

<div class="toolbar">
  <span class="toolbar-title">üìã ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</span>
  <div class="toolbar-actions">
    <button class="btn btn-outline" onclick="resetForm()">üîÑ ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    <button class="btn btn-primary" id="pdfBtn" onclick="exportPDF()">üìÑ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å / ‡πÅ‡∏ä‡∏£‡πå PDF</button>
  </div>
</div>

<div class="page-wrapper">
  <div class="form-instructions">
    ‚ÑπÔ∏è ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î <strong>"‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å / ‡πÅ‡∏ä‡∏£‡πå PDF"</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏ä‡∏£‡πå‡∏ú‡πà‡∏≤‡∏ô Line ‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏≠‡∏û‡∏≠‡∏∑‡πà‡∏ô‡πÜ
  </div>

  <div id="document">
    <div class="doc-title">‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</div>
    <div class="doc-subtitle">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á : Service Staff</div>

```
<div class="info-grid">
  <div class="info-field">
    <span class="info-label">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</span>
    <input class="info-input" id="empName" type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô">
  </div>
  <div class="info-field">
    <span class="info-label">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (ID)</span>
    <input class="info-input" id="empId" type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô">
  </div>
  <div class="info-field">
    <span class="info-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ</span>
    <input class="info-input" id="station" type="text" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ">
  </div>
</div>

<div class="instruction-box">
  ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ <strong>‚úì</strong> ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á <strong>"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô"</strong> ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•/‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠
</div>

<table class="eval-table" id="evalTable">
  <thead>
    <tr>
      <th rowspan="2">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
      <th rowspan="2" style="text-align:left;">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</th>
      <th colspan="2" style="text-align:center;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</th>
      <th rowspan="2">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• / ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</th>
    </tr>
    <tr>
      <th class="th-fail">‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</th>
      <th class="th-pass">‡∏ú‡πà‡∏≤‡∏ô</th>
    </tr>
  </thead>
  <tbody id="evalBody"></tbody>
</table>

<div class="summary-section">
  <div class="summary-title">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</div>
  <div class="summary-body">
    <textarea class="additional-remark" id="additionalRemark" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..."></textarea>
    <div class="result-label">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</div>
    <div class="result-options">
      <label class="result-option" id="failOption">
        <input type="radio" name="result" value="fail" onchange="updateResult('fail')">
        <div class="result-text"><strong>‚ùå ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</strong> ‚Äî ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</div>
      </label>
      <label class="result-option" id="passOption">
        <input type="radio" name="result" value="pass" onchange="updateResult('pass')">
        <div class="result-text"><strong>‚úÖ ‡∏ú‡πà‡∏≤‡∏ô</strong> ‚Äî ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏î‡πâ</div>
      </label>
    </div>
  </div>
</div>

<div class="signature-section">
  <div class="sig-box">
    <div class="sig-title">‡∏ô‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ</div>
    <input class="sig-name-input" id="sigName" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ">
    <div class="sig-date" id="sigDate"></div>
  </div>
</div>
```

  </div>
</div>

<!-- Remark Modal -->

<div class="modal-overlay" id="remarkModal" onclick="closeModalOnBg(event)">
  <div class="modal-box">
    <div class="modal-handle"></div>
    <div class="modal-title" id="modalTitle">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• / ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</div>
    <div class="modal-subtitle" id="modalSubtitle">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà 1</div>
    <textarea class="modal-textarea" id="modalTextarea" maxlength="500"
      placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞..." oninput="updateCharCount()"></textarea>
    <div class="modal-char" id="modalChar">0 / 500 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</div>
    <div class="modal-actions">
      <button class="modal-btn modal-btn-cancel" onclick="closeModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      <button class="modal-btn modal-btn-save"   onclick="saveRemark()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
    </div>
  </div>
</div>

<div class="score-badge">
  <div class="score-label">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</div>
  <div class="score-number" id="scoreNumber">0/8</div>
  <div class="score-bar"><div class="score-fill" id="scoreFill" style="width:0%"></div></div>
  <div class="score-label" style="margin-top:2px;font-size:0.64rem;" id="scorePercent">0%</div>
</div>

<script>
const criteria = [
  "‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ß‡∏•‡∏≤ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ",
  "‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‡∏ú‡∏π‡πâ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£",
  "‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡∏ä‡∏µ‡πâ‡πÅ‡∏à‡∏á‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£‡∏´‡πâ‡∏≤‡∏°‡∏Å‡∏¥‡∏ô ‡∏´‡πâ‡∏≤‡∏°‡∏î‡∏∑‡πà‡∏°",
  "‡∏Å‡∏≤‡∏£‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á, ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ)",
  "‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏û‡∏π‡∏î‡πÅ‡∏•‡∏∞‡∏ô‡πâ‡∏≥‡πÄ‡∏™‡∏µ‡∏¢‡∏á",
  "‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏¥‡∏¢‡∏≤‡∏°‡∏≤‡∏£‡∏¢‡∏≤‡∏ó",
  "‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô",
  "‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢"
];

let scores  = new Array(8).fill(null);
let remarks = new Array(8).fill('');
let selectedResult = null;

function buildTable() {
  const tbody = document.getElementById('evalBody');
  tbody.innerHTML = '';
  criteria.forEach((c, i) => {
    const tr = document.createElement('tr');
    tr.id = 'row' + i;
    tr.innerHTML = `
      <td class="row-num">${i+1}</td>
      <td class="criteria-text">${c}</td>
      <td class="radio-cell">
        <input type="radio" name="eval${i}" value="fail" onchange="setScore(${i},'fail')" style="width:20px;height:20px;accent-color:#b03025;cursor:pointer;">
      </td>
      <td class="radio-cell">
        <input type="radio" name="eval${i}" value="pass" onchange="setScore(${i},'pass')" style="width:20px;height:20px;accent-color:#1f6b3a;cursor:pointer;">
      </td>
      <td class="remark-cell" onclick="openModal(${i})">
        <div class="remark-preview" id="remark-preview-${i}">
          <span class="remark-placeholder">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å...</span>
        </div>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

/* ===== MODAL ===== */
let currentModalIdx = null;

function openModal(idx) {
  currentModalIdx = idx;
  document.getElementById('modalTitle').textContent = '‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• / ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞';
  document.getElementById('modalSubtitle').textContent = `‡∏Ç‡πâ‡∏≠ ${idx + 1} ‚Äî ${criteria[idx]}`;
  document.getElementById('modalTextarea').value = remarks[idx] || '';
  updateCharCount();
  document.getElementById('remarkModal').classList.add('active');
  setTimeout(() => document.getElementById('modalTextarea').focus(), 200);
}

function closeModal() {
  document.getElementById('remarkModal').classList.remove('active');
  currentModalIdx = null;
}

function closeModalOnBg(e) {
  if (e.target === document.getElementById('remarkModal')) closeModal();
}

function updateCharCount() {
  const val = document.getElementById('modalTextarea').value;
  const charEl = document.getElementById('modalChar');
  charEl.textContent = `${val.length} / 500 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£`;
  charEl.className = 'modal-char' + (val.length >= 450 ? ' near-limit' : '');
}

function saveRemark() {
  if (currentModalIdx === null) return;
  const text = document.getElementById('modalTextarea').value.trim();
  remarks[currentModalIdx] = text;
  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï preview cell
  const preview = document.getElementById('remark-preview-' + currentModalIdx);
  if (text) {
    preview.innerHTML = `<span class="remark-text">${escapeHtml(text)}</span>`;
  } else {
    preview.innerHTML = `<span class="remark-placeholder">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å...</span>`;
  }
  closeModal();
}

function escapeHtml(str) {
  return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

function setScore(idx, val) {
  scores[idx] = val;
  const row = document.getElementById('row' + idx);
  row.className = val === 'pass' ? 'row-pass' : 'row-fail';
  updateScore();
}

function updateScore() {
  const passed = scores.filter(s => s === 'pass').length;
  const pct = Math.round((passed / 8) * 100);
  document.getElementById('scoreNumber').textContent = passed + '/8';
  document.getElementById('scoreFill').style.width = pct + '%';
  document.getElementById('scorePercent').textContent = pct + '%';
}

function updateResult(val) {
  selectedResult = val;
  document.getElementById('failOption').className = 'result-option' + (val === 'fail' ? ' selected-fail' : '');
  document.getElementById('passOption').className = 'result-option' + (val === 'pass' ? ' selected-pass' : '');
}

function resetForm() {
  if (!confirm('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')) return;
  document.querySelectorAll('input[type="text"], textarea').forEach(el => el.value = '');
  document.querySelectorAll('input[type="radio"]').forEach(el => el.checked = false);
  scores = new Array(8).fill(null);
  remarks = new Array(8).fill('');
  selectedResult = null;
  document.querySelectorAll('#evalBody tr').forEach(tr => tr.className = '');
  document.getElementById('failOption').className = 'result-option';
  document.getElementById('passOption').className = 'result-option';
  // ‡∏•‡πâ‡∏≤‡∏á remark previews
  criteria.forEach((_, i) => {
    const preview = document.getElementById('remark-preview-' + i);
    if (preview) preview.innerHTML = `<span class="remark-placeholder">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏£‡∏≠‡∏Å...</span>`;
  });
  updateScore();
}

/* ===================================================
   PDF EXPORT ‚Äî ‡∏™‡∏£‡πâ‡∏≤‡∏á static clone ‡πÅ‡∏•‡πâ‡∏ß capture
   ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡∏û‡∏≠‡∏î‡∏µ 1 ‡∏´‡∏ô‡πâ‡∏≤ A4, ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å,
   ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ä‡πâ ‚úì ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà radio button
   =================================================== */
async function exportPDF() {
  const btn = document.getElementById('pdfBtn');
  btn.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á...';
  btn.disabled = true;

  try {
    const node = buildPrintNode();
    document.body.appendChild(node);

    // ‡∏£‡∏≠ font ‡πÇ‡∏´‡∏•‡∏î
    await document.fonts.ready;
    await new Promise(r => setTimeout(r, 300));

    const canvas = await html2canvas(node, {
      scale: 2,
      useCORS: true,
      backgroundColor: '#ffffff',
      logging: false,
      width: 754,
      windowWidth: 754
    });

    document.body.removeChild(node);

    const { jsPDF } = window.jspdf;
    const pdf = new jsPDF({ orientation: 'portrait', unit: 'mm', format: 'a4' });
    const PW = pdf.internal.pageSize.getWidth();   // 210
    const PH = pdf.internal.pageSize.getHeight();  // 297

    const ratio = canvas.width / canvas.height;
    let dw = PW, dh = PW / ratio;
    if (dh > PH) { dh = PH; dw = PH * ratio; }
    const ox = (PW - dw) / 2;
    const oy = (PH - dh) / 2;

    pdf.addImage(canvas.toDataURL('image/jpeg', 0.97), 'JPEG', ox, oy, dw, dh);

    const empName = document.getElementById('empName').value.trim() || '‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô';
    const empId   = document.getElementById('empId').value.trim()   || 'ID';
    const filename = `‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô_${empName}_${empId}.pdf`;
    const blob = pdf.output('blob');
    const file = new File([blob], filename, { type: 'application/pdf' });

    // mobile: share sheet (PDF only ‚Äî ‡πÑ‡∏°‡πà‡∏°‡∏µ text/plain)
    if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
      await navigator.share({ title: '‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô', files: [file] });
    } else {
      // desktop: download PDF
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = filename;
      document.body.appendChild(a); a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

  } catch(e) {
    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + e.message);
    console.error(e);
  }

  btn.textContent = 'üìÑ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å / ‡πÅ‡∏ä‡∏£‡πå PDF';
  btn.disabled = false;
}

function buildPrintNode() {
  const empName  = document.getElementById('empName').value.trim()  || '-';
  const empId    = document.getElementById('empId').value.trim()    || '-';
  const station  = document.getElementById('station').value.trim()  || '-';
  const addRmk   = document.getElementById('additionalRemark').value.trim() || '-';
  const sigName  = document.getElementById('sigName').value.trim()  || '';
  const today    = new Date().toLocaleDateString('th-TH',{ year:'numeric', month:'long', day:'numeric' });

  // ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô ‚Äî ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
  let resultHTML = '';
  if (selectedResult === 'fail') {
    resultHTML = `<div style="display:block;padding:8px 14px;border:2px solid #b03025;border-radius:5px;background:#fdf0f0;font-size:12px;font-family:'Sarabun',sans-serif;color:#b03025;">
      <strong style="font-family:'Prompt',sans-serif;font-size:13px;">‚ùå ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</strong>
      <span style="color:#4a4a4a;"> ‚Äî ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</span>
    </div>`;
  } else if (selectedResult === 'pass') {
    resultHTML = `<div style="display:block;padding:8px 14px;border:2px solid #1f6b3a;border-radius:5px;background:#e8f4ec;font-size:12px;font-family:'Sarabun',sans-serif;color:#1f6b3a;">
      <strong style="font-family:'Prompt',sans-serif;font-size:13px;">‚úÖ ‡∏ú‡πà‡∏≤‡∏ô</strong>
      <span style="color:#4a4a4a;"> ‚Äî ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏î‡πâ</span>
    </div>`;
  } else {
    resultHTML = `<div style="display:block;padding:8px 14px;border:1.5px solid #ccc;border-radius:5px;font-size:12px;color:#999;font-family:'Sarabun',sans-serif;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</div>`;
  }

  // ‡πÅ‡∏ñ‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‚Äî ‡πÉ‡∏ä‡πâ ‚úì ‡πÅ‡∏ó‡∏ô radio
  let rowsHTML = '';
  criteria.forEach((c, i) => {
    const isFail = scores[i] === 'fail';
    const isPass = scores[i] === 'pass';
    let bg = i % 2 === 0 ? '#ffffff' : '#f6f4ef';
    if (isFail) bg = '#f8d7da';
    if (isPass) bg = '#d4edda';
    const failMark = isFail ? `<span style="color:#b03025;font-size:16px;font-weight:700;">‚úì</span>` : '';
    const passMark = isPass ? `<span style="color:#1f6b3a;font-size:16px;font-weight:700;">‚úì</span>` : '';
    rowsHTML += `
      <tr style="background:${bg};">
        <td style="text-align:center;font-weight:700;color:#fff;background:#2a3d6b;width:36px;padding:7px 4px;border:1px solid #ccc5b5;font-family:'Prompt',sans-serif;">${i+1}</td>
        <td style="padding:7px 10px;border:1px solid #ccc5b5;font-size:11.5px;line-height:1.45;font-family:'Sarabun',sans-serif;">${c}</td>
        <td style="text-align:center;padding:7px 4px;border:1px solid #ccc5b5;width:56px;">${failMark}</td>
        <td style="text-align:center;padding:7px 4px;border:1px solid #ccc5b5;width:56px;">${passMark}</td>
        <td style="padding:7px 10px;border:1px solid #ccc5b5;font-size:11px;color:#444;font-family:'Sarabun',sans-serif;">${remarks[i]||''}</td>
      </tr>`;
  });

  const wrap = document.createElement('div');
  wrap.style.cssText = `
    position:fixed; top:-9999px; left:-9999px;
    width:754px;
    background:#fff;
    padding:32px 40px;
    font-family:'Sarabun',sans-serif;
    color:#2c2c2c;
  `;

  wrap.innerHTML = `
    <div style="text-align:center;font-family:'Prompt',sans-serif;font-size:17px;font-weight:700;color:#1a2744;border-bottom:2.5px solid #c9a84c;padding-bottom:7px;margin-bottom:5px;">
      ‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô
    </div>
    <div style="text-align:center;font-size:12px;color:#6b6b6b;margin-bottom:14px;font-family:'Prompt',sans-serif;">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á : Service Staff</div>

    <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:12px;">
      <div>
        <div style="font-size:9.5px;color:#6b6b6b;font-weight:700;text-transform:uppercase;letter-spacing:0.06em;margin-bottom:2px;font-family:'Sarabun',sans-serif;">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</div>
        <div style="border-bottom:1.5px solid #c5b99a;padding:3px 2px;font-size:13px;font-family:'Sarabun',sans-serif;">${empName}</div>
      </div>
      <div>
        <div style="font-size:9.5px;color:#6b6b6b;font-weight:700;text-transform:uppercase;letter-spacing:0.06em;margin-bottom:2px;font-family:'Sarabun',sans-serif;">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô (ID)</div>
        <div style="border-bottom:1.5px solid #c5b99a;padding:3px 2px;font-size:13px;font-family:'Sarabun',sans-serif;">${empId}</div>
      </div>
      <div>
        <div style="font-size:9.5px;color:#6b6b6b;font-weight:700;text-transform:uppercase;letter-spacing:0.06em;margin-bottom:2px;font-family:'Sarabun',sans-serif;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ</div>
        <div style="border-bottom:1.5px solid #c5b99a;padding:3px 2px;font-size:13px;font-family:'Sarabun',sans-serif;">${station}</div>
      </div>
    </div>

    <div style="background:#f0ede6;border-left:4px solid #c9a84c;padding:7px 12px;font-size:11px;color:#4a4a4a;margin-bottom:12px;border-radius:0 4px 4px 0;line-height:1.6;font-family:'Sarabun',sans-serif;">
      ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢ <strong style="color:#1a2744;">‚úì</strong> ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á <strong style="color:#1a2744;">"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô"</strong> ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•/‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠
    </div>

    <table style="width:100%;border-collapse:collapse;margin-bottom:14px;font-size:11.5px;">
      <thead>
        <tr>
          <th rowspan="2" style="background:#1a2744;color:#fff;padding:8px 6px;border:1px solid #0d1a35;width:36px;text-align:center;font-family:'Prompt',sans-serif;font-weight:600;vertical-align:middle;">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
          <th rowspan="2" style="background:#1a2744;color:#fff;padding:8px 10px;border:1px solid #0d1a35;text-align:left;font-family:'Prompt',sans-serif;font-weight:600;vertical-align:middle;">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</th>
          <th colspan="2" style="background:#1a2744;color:#fff;padding:8px 6px;border:1px solid #0d1a35;text-align:center;font-family:'Prompt',sans-serif;font-weight:600;">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</th>
          <th rowspan="2" style="background:#1a2744;color:#fff;padding:8px 10px;border:1px solid #0d1a35;text-align:center;font-family:'Prompt',sans-serif;font-weight:600;vertical-align:middle;">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• / ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</th>
        </tr>
        <tr>
          <th style="background:#b03025;color:#fff;padding:5px 0;text-align:center;border:1px solid #8a1f18;font-weight:700;width:56px;font-family:'Prompt',sans-serif;font-size:11px;">‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</th>
          <th style="background:#1f6b3a;color:#fff;padding:5px 0;text-align:center;border:1px solid #144d28;font-weight:700;width:56px;font-family:'Prompt',sans-serif;font-size:11px;">‡∏ú‡πà‡∏≤‡∏ô</th>
        </tr>
      </thead>
      <tbody>${rowsHTML}</tbody>
    </table>

    <div style="border:1.5px solid #c5b99a;border-radius:6px;overflow:hidden;margin-bottom:14px;">
      <div style="background:#f0ede6;padding:6px 12px;font-weight:700;font-size:11.5px;color:#1a2744;border-bottom:1px solid #c5b99a;font-family:'Prompt',sans-serif;">‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</div>
      <div style="padding:9px 12px;font-size:12px;min-height:32px;color:#2c2c2c;font-family:'Sarabun',sans-serif;">${addRmk}</div>
      <div style="padding:0 12px 10px;">
        <div style="font-size:11.5px;font-weight:700;color:#1a2744;margin-bottom:6px;font-family:'Prompt',sans-serif;">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</div>
        ${resultHTML}
      </div>
    </div>

    <div style="display:flex;justify-content:center;margin-top:10px;">
      <div style="text-align:center;width:200px;">
        <div style="font-size:11px;color:#6b6b6b;font-weight:700;font-family:'Prompt',sans-serif;margin-bottom:4px;">‡∏ô‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ</div>
        <div style="border-bottom:1.5px solid #c5b99a;padding:3px 8px;font-size:13px;min-height:20px;font-family:'Sarabun',sans-serif;">${sigName}</div>
        <div style="font-size:10.5px;color:#6b6b6b;margin-top:4px;font-family:'Sarabun',sans-serif;">${today}</div>
      </div>
    </div>
  `;

  return wrap;
}

// Init
buildTable();
updateScore();
document.getElementById('sigDate').textContent =
  new Date().toLocaleDateString('th-TH',{ year:'numeric', month:'long', day:'numeric' });
</script>

</body>
</html>
