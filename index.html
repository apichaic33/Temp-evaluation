<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>แบบประเมินพนักงาน</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
body{
    font-family: sans-serif;
    background:#f5f5f5;
    padding:40px;
}
.container{
    background:white;
    padding:30px;
    max-width:900px;
    margin:auto;
    box-shadow:0 0 10px rgba(0,0,0,0.1);
}
h2{margin-bottom:20px;}
.row{display:flex; gap:20px; margin-bottom:15px;}
.row input{padding:8px; flex:1;}
table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}
table, th, td{
    border:1px solid #000;
}
th, td{
    padding:8px;
    text-align:left;
    font-size:14px;
}
th{
    background:#eee;
}
.center{text-align:center;}
button{
    margin-top:20px;
    padding:10px 20px;
    background:black;
    color:white;
    border:none;
    cursor:pointer;
}
button:hover{opacity:0.8;}
</style>
</head>
<body>

<div class="container">
<h2>แบบประเมินพนักงาน</h2>

<div class="row">
<input type="text" id="firstName" placeholder="ชื่อ">
<input type="text" id="lastName" placeholder="นามสกุล">
</div>

<div class="row">
<input type="text" id="empId" placeholder="ID">
<input type="text" id="station" placeholder="สถานี">
</div>

<table>
<thead>
<tr>
<th>ลำดับ</th>
<th>หัวข้อการประเมิน</th>
<th class="center">ไม่ผ่าน</th>
<th class="center">ผ่าน</th>
</tr>
</thead>
<tbody id="evaluationTable">
</tbody>
</table>

<button onclick="generatePDF()">Export PDF</button>

</div>

<script>
const topics = [
"การเตรียมพร้อมเพื่อเริ่มงาน มาก่อนเวลา",
"การให้บริการผู้โดยสาร",
"การแก้ไขปัญหา เช่น การชี้แจงผู้โดยสาร",
"การอธิบายข้อมูล (การเดินทางอื่นๆ)",
"การใช้คำพูดและน้ำเสียง",
"การแต่งกาย บุคลิก และกริยามารยาท",
"มนุษย์สัมพันธ์ระหว่างเพื่อนร่วมงาน",
"การปฏิบัติตามที่หัวหน้าสถานีมอบหมาย"
];

const table = document.getElementById("evaluationTable");

topics.forEach((topic, index)=>{
    table.innerHTML += `
    <tr>
        <td>${index+1}</td>
        <td>${topic}</td>
        <td class="center"><input type="radio" name="q${index}" value="ไม่ผ่าน"></td>
        <td class="center"><input type="radio" name="q${index}" value="ผ่าน"></td>
    </tr>
    `;
});

async function generatePDF(){
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    const firstName = document.getElementById("firstName").value;
    const lastName = document.getElementById("lastName").value;
    const empId = document.getElementById("empId").value;
    const station = document.getElementById("station").value;

    doc.setFont("helvetica");
    doc.setFontSize(14);
    doc.text("แบบประเมินพนักงาน", 80, 15);

    doc.setFontSize(12);
    doc.text(`ชื่อ: ${firstName} ${lastName}`, 20, 30);
    doc.text(`ID: ${empId}`, 120, 30);
    doc.text(`สถานี: ${station}`, 20, 40);

    let y = 55;

    topics.forEach((topic, index)=>{
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        const result = selected ? selected.value : "-";

        doc.text(`${index+1}. ${topic}`, 20, y);
        doc.text(`ผลประเมิน: ${result}`, 160, y);
        y += 10;
    });

    doc.save("evaluation.pdf");
}
</script>

</body>
</html>
